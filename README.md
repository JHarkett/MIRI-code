# MIRI-code
A collection of scripts to run the JWST calibration pipeline and visulise the data afterwards


For the JWST calibration pipeline:
  Use jwstpipeline_v4.py to combine the dither positions in stage 3
  Use jwstpipeline_singledither_v2.py to leave these dither positions seperate

![Screenshot 2022-10-03 at 11 55 09](https://user-images.githubusercontent.com/93939955/199545504-b326b129-9e50-4ff5-819d-b50638a0ca13.png)

To map the data using Pat Fry's code, use:
  navigation2.py
  jupkerns.tm
  jwst_kernels


To plot spectra from a lat/lon point in the resulting band cubes use:
  plot_pixseperate_v3.py


To save each spaxel in a band as a spectral txt file (useful for retrievals) use:
  retrieval_map.py
This will also save latitude, longitude and emission angle (mu) in fits files in the same directory


To visulise the data as a RGB image (using 3 different RGB wavelengths) use:
  plot_pixseperate_v3.py
  visulise_single.py
  build_mosaic_1.py
  build_mosaic_2.py
  visulise_mosaic.py


To generate spx files (for NEMESIS) using a txt file input (like the ones generated by retrieval_map.py) use:
  gen_spx.py


To generate contribution functions using the results of a NEMESIS forward model use:
  plot_contribution.py
